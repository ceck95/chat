// publisher = client.publish('/messages', {
//   message: '<%= j render @message  %>'
// });

// publisher.callback(function() {
	 //  var t = $('#bb .answer');
  // // console.log('...',$('#bb').scrollTop(t.length * $(t).first().height() + 50))
  // // var t = $('#bb .answer');
  // $('#bb').scrollTop(t.length * $(t).first().height() + 50);
  // // console.log('....',t.length * $(t).first().height() + 50)
  // $('#message_body').val('');
  // $('#message_body').attr('disabled',false);
  // $('.send-btn').html('Send')
  // $('#message_body').focus();
  // $('#new_message').find("input[type='submit']").val('Submit').prop('disabled', false)
// });

// publisher.errback(function() {
//   alert('There was an error while posting your comment.');
// });
<% publish_to "/messages" do %>
  var testcm = $('#tcm').text();
  $('.chat-body').append('<%= j render @message  %>');
  if(testcm == 'b'){
  $('#bb .answer').last().addClass('right');
  $('#tcm').empty();
  }
  else
  $('#bb .answer').last().addClass('left');
  var t = $('#bb .answer');
  $('#bb').scrollTop(t.length * $(t).first().height() + 50);
<% end %>
  var t = $('#bb .answer');
// console.log('...',$('#bb').scrollTop(t.length * $(t).first().height() + 50))
// var t = $('#bb .answer');
$('#bb').scrollTop(t.length * $(t).first().height() + 50);
// console.log('....',t.length * $(t).first().height() + 50)
$('#message_body').val('');
$('#message_body').attr('disabled',false);
$('.send-btn').html('Send')
$('#message_body').focus();
$('#new_message').find("input[type='submit']").val('Submit').prop('disabled', false)